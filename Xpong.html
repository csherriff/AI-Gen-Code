<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagonal Bounce Pong Game - Red vs Blue</title>
    <style>
        canvas {
            background: #000;
            display: block;
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="400" height="400"></canvas>
    <script>
    let canvas;
    let ctx;
    let ballX = 200;
    let ballY = 200;
    let ballSpeedX = 5;  // Initial speed in X direction
    let ballSpeedY = 5;  // Initial speed in Y direction, ensuring diagonal movement
    let paddle1Y = 175;
    let paddle2Y = 175;
    const PADDLE_HEIGHT = 100;
    const PADDLE_WIDTH = 10;
    const BALL_SIZE = 20; // Size of the 'X' ball

    function init() {
        canvas = document.getElementById("gameCanvas");
        ctx = canvas.getContext('2d');
        setInterval(gameLoop, 1000/60); // 60 FPS
    }

    function gameLoop() {
        moveBall();
        movePaddleAI(paddle1Y, ballY, ballSpeedX < 0);
        movePaddleAI(paddle2Y, ballY, ballSpeedX > 0);
        drawEverything();
    }

    function moveBall() {
        ballX += ballSpeedX;
        ballY += ballSpeedY;

        // Bounce off the top and bottom
        if(ballY < 0 || ballY > canvas.height) {
            ballSpeedY = -ballSpeedY;
        }

        // Bounce off the sides
        if(ballX < 0 || ballX > canvas.width) {
            ballSpeedX = -ballSpeedX;
            // Adjust ball's vertical speed for more dynamic gameplay
            ballSpeedY += (Math.random() * 2 - 1) * 2; // Randomly change vertical speed
            if(Math.abs(ballSpeedY) < 3) ballSpeedY = 3 * Math.sign(ballSpeedY); // Ensure minimum speed
            if(Math.abs(ballSpeedY) > 7) ballSpeedY = 7 * Math.sign(ballSpeedY); // Cap maximum speed
        }

        // Check for paddle collision on both sides
        checkPaddleCollision(paddle1Y, 0);
        checkPaddleCollision(paddle2Y, canvas.width - PADDLE_WIDTH);
    }

    function checkPaddleCollision(paddleY, paddleX) {
        if(ballX > paddleX && ballX < paddleX + PADDLE_WIDTH && 
           ballY > paddleY && ballY < paddleY + PADDLE_HEIGHT) {
            ballSpeedX = -ballSpeedX;
            // Calculate new vertical speed based on where the ball hits the paddle
            let deltaY = ballY - (paddleY + PADDLE_HEIGHT/2);
            ballSpeedY = deltaY * 0.35;
            // Ensure the ball keeps moving diagonally
            if(Math.abs(ballSpeedY) < 3) ballSpeedY = 3 * Math.sign(ballSpeedY);
        }
    }

    function movePaddleAI(paddleY, ballY, isLeft) {
        // Simple AI: move towards the ball's predicted Y position
        let predictedY = ballY + (isLeft ? -ballSpeedX : ballSpeedX) * (Math.abs((isLeft ? ballX : (canvas.width - ballX)) / ballSpeedX));
        if(predictedY < paddleY + PADDLE_HEIGHT/2) paddleY -= 6;
        if(predictedY > paddleY + PADDLE_HEIGHT/2) paddleY += 6;

        // Boundary check
        if(paddleY < 0) paddleY = 0;
        if(paddleY > canvas.height - PADDLE_HEIGHT) paddleY = canvas.height - PADDLE_HEIGHT;

        if(isLeft) {
            paddle1Y = paddleY;
        } else {
            paddle2Y = paddleY;
        }
    }

    function drawEverything() {
        // Clear canvas
        ctx.fillStyle = 'black';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        // Draw ball as 'X'
        ctx.font = `${BALL_SIZE}px serif`;
        ctx.fillStyle = 'white';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText('X', ballX, ballY);

        // Draw paddles
        ctx.fillStyle = 'red';
        ctx.fillRect(0, paddle1Y, PADDLE_WIDTH, PADDLE_HEIGHT);
        ctx.fillStyle = 'blue';
        ctx.fillRect(canvas.width - PADDLE_WIDTH, paddle2Y, PADDLE_WIDTH, PADDLE_HEIGHT);
    }

    init();
    </script>
</body>
</html>
